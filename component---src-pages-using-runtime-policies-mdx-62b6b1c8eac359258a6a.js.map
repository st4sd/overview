{"version":3,"file":"component---src-pages-using-runtime-policies-mdx-62b6b1c8eac359258a6a.js","mappings":"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","sources":["webpack://st4sd-overview/./src/pages/using-runtime-policies.mdx"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/vassiliad/projects/st4sd/overview/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst PageDescription = makeShortcode(\"PageDescription\");\nconst AnchorLinks = makeShortcode(\"AnchorLinks\");\nconst AnchorLink = makeShortcode(\"AnchorLink\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    {/*\n       Copyright IBM Inc. All Rights Reserved.\n      SPDX-License-Identifier: Apache-2.0\n     */}\n    <PageDescription mdxType=\"PageDescription\">\n      <p>{`Use this page to learn how to use the ST4SD runtime policies, for example to execute parameterised packages that contain surrogate models.`}</p>\n    </PageDescription>\n    <AnchorLinks mdxType=\"AnchorLinks\">\n  <AnchorLink mdxType=\"AnchorLink\">What is a runtime policy?</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">How to use a runtime policy?</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Policy: prefer-surrogate</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Policy: random-canary-surrogate</AnchorLink>\n    </AnchorLinks>\n    <h2>{`What is a runtime policy?`}</h2>\n    <p>{`Runtime policies are algorithms which modify the default behaviour of ST4SD when its asked to run a parameterised package.`}</p>\n    <h2>{`How to use a runtime policy?`}</h2>\n    <p>{`You can use a runtime policy by configuring the `}<inlineCode parentName=\"p\">{`runtimePolicy`}</inlineCode>{` field of the `}<inlineCode parentName=\"p\">{`api_experiment_start()`}</inlineCode>{` `}<a parentName=\"p\" {...{\n        \"href\": \"/overview/running-workflows-on-openshift#running-a-virtual-experiment\"\n      }}>{`payload`}</a>{`.`}</p>\n    <h3>{`Example`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`from __future__ import typing\nimport json\ndef experiment_start(api: experiment.service.db.ExperimentRestAPI) -> str:\n    \"\"\"Start an experiment that uses the prefer-surrogate runtime policy\n\n    Arguments:\n      api: An instance of ExperimentRestAPI that has connected to your\n           private ST4SD registry\n\n    Notes:\n\n      The method expects that you have already created the band-gap-dft-gamess-us\n      parameterised package on your ST4SD registry and have synthesized (or imported)\n      a surrogate parameterised package that can substitute band-gap-dft-gamess-us.\n\n    Returns:\n        The UID of the resulting instance\n    \"\"\"\n\n    payload = {\n        \"inputs\": [\n            {\"filename\": \"input_smiles.csv\", \"content\": \"label,smiles\\\\nmy_molecule,CCC\"}\n        ],\n        \"runtimePolicy\": {\n          \"name\": \"prefer-surrogate\"\n        }\n    }\n\n    return api.api_experiment_start(\n        # the identifier of the parameterised virtual experiment package\n        \"band-gap-dft-gamess-us\",\n        payload)\n`}</code></pre>\n    <h2>{`Policy: prefer-surrogate`}</h2>\n    <p>{`The algorithm of the policy is:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Find a suitable surrogate package of the requested parameterised package in the `}<inlineCode parentName=\"li\">{`api_experiment_start()`}</inlineCode>{` payload`}\n        <ol parentName=\"li\">\n          <li parentName=\"ol\">{`Find parameterised packages that are the result of synthesizing a `}<a parentName=\"li\" {...{\n              \"href\": \"/overview/using-graph-relationships#automatically-synthesize-new-parameterised-packages\"\n            }}>{`transformation relationship`}</a>{`, AND`}</li>\n          <li parentName=\"ol\">{`The `}<a parentName=\"li\" {...{\n              \"href\": \"/overview/using-graph-relationships#structure-of-a-relationship\"\n            }}>{`outputGraph`}</a>{` of the associated `}<inlineCode parentName=\"li\">{`transformation relationship`}</inlineCode>{` matches a subGraph of the requested parameterised package.`}</li>\n        </ol>\n      </li>\n      <li parentName=\"ol\">{`If there is a suitable surrogate parameterised package then start it and return the UID of the resulting run.`}</li>\n      <li parentName=\"ol\">{`Otherwise, start and return the UID of the requested parameterised packages.`}</li>\n    </ol>\n    <p>{`The schema of the `}<inlineCode parentName=\"p\">{`runtimePolicy`}</inlineCode>{` field in the `}<inlineCode parentName=\"p\">{`api_experiment_start()`}</inlineCode>{` payload (in `}<inlineCode parentName=\"p\">{`YAML`}</inlineCode>{` format) is:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`runtimePolicy:\n  name: prefer-surrogate\n`}</code></pre>\n    <h2>{`Policy: random-canary-surrogate`}</h2>\n    <p>{`In a future version the runtime system will automatically invoke this runtime-policy. However, users can also switch it on manually for their virtual experiment runs.`}</p>\n    <p>{`The algorithm of the policy is:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Toss a weighted coin which shows heads with probability `}<inlineCode parentName=\"li\">{`probabilitySurrogate`}</inlineCode>{`. If the coin shows heads when it lands then attempt to start 2 virtual experiment instances. The requested one AND a surrogate of the requested one (if available).`}\n        <ol parentName=\"li\">\n          <li parentName=\"ol\">{`If coin shows `}<inlineCode parentName=\"li\">{`heads`}</inlineCode>{`: then attempt to start 2 virtual experiment instances. An instance using the requested parameterised package from the `}<inlineCode parentName=\"li\">{`api_experiment_start()`}</inlineCode>{` payload and a second one of a suitable surrogate parameterised package (if present). If there is no suitable surrogate parameterised package then start just one run of the requested parameterised package.`}</li>\n          <li parentName=\"ol\">{`Use the same logic as the “prefer-surrogate” to identify one surrogate parameterised package.`}</li>\n        </ol>\n      </li>\n      <li parentName=\"ol\">{`If the coin shows `}<inlineCode parentName=\"li\">{`tails`}</inlineCode>{` then start just the requested parameterised package`}</li>\n      <li parentName=\"ol\">{`Return the UID of the instance for the parameterised package.`}</li>\n    </ol>\n    <p>{`The schema of the `}<inlineCode parentName=\"p\">{`runtimePolicy`}</inlineCode>{` field in the `}<inlineCode parentName=\"p\">{`api_experiment_start()`}</inlineCode>{` payload (in `}<inlineCode parentName=\"p\">{`YAML`}</inlineCode>{` format) is:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`runtimePolicy:\n  name: random-canary-surrogate\n  config: # optional\n    probabilitySurrogate: float from 0.0 to 1.0 (optional, default is 0.5)\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","makeShortcode","name","props","console","warn","mdx","PageDescription","AnchorLinks","AnchorLink","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","_objectWithoutProperties","_excluded","Object","assign","mdxType","parentName","isMDXComponent"],"sourceRoot":""}
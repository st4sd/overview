"use strict";(self.webpackChunkst4sd_overview=self.webpackChunkst4sd_overview||[]).push([[806],{2847:function(e,n,a){a.r(n),a.d(n,{_frontmatter:function(){return r},default:function(){return k}});var t=a(3366),o=(a(7294),a(4983)),i=a(1217),s=["components"],r={},l=function(e){return function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",n)}},m=l("PageDescription"),c=l("AnchorLinks"),p=l("AnchorLink"),u=l("InlineNotification"),d={_frontmatter:r},h=i.Z;function k(e){var n=e.components,a=(0,t.Z)(e,s);return(0,o.kt)(h,Object.assign({},d,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)(m,{mdxType:"PageDescription"},(0,o.kt)("p",null,"Manage the access rights of users in your ST4SD deployment on OpenShift.")),(0,o.kt)(c,{mdxType:"AnchorLinks"},(0,o.kt)(p,{mdxType:"AnchorLink"},"Give a group of users full access to the ST4SD namespace"),(0,o.kt)(p,{mdxType:"AnchorLink"},"Give a group of users access to just the ST4SD microservices"),(0,o.kt)(p,{mdxType:"AnchorLink"},"Role objects that ST4SD creates in its namespace"),(0,o.kt)(p,{mdxType:"AnchorLink"},"Enable a namespace administrator to install ST4SD in a namespace")),(0,o.kt)("p",null,"We recommend grouping your users based on their intended access level to your ST4SD deployment and then using a RoleBinding to configure the Role Based Access Control (RBAC) settings of the Group object."),(0,o.kt)("h2",null,"Give a group of users full access to the ST4SD namespace"),(0,o.kt)("p",null,"For example, if you wish to configure the RBAC of the users ",(0,o.kt)("inlineCode",{parentName:"p"},"A")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"B")," so that they have full access to the ST4SD microservices and the objects in the same namespace. Put the following in a file called ",(0,o.kt)("inlineCode",{parentName:"p"},"group-full-access.yaml"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"kind: Group\napiVersion: user.openshift.io/v1\nmetadata:\n  name: st4sd-full-access-my-namespace\nusers:\n  - Account name of user A\n  - Account name of user B\n")),(0,o.kt)("p",null,"Then create the following file ",(0,o.kt)("inlineCode",{parentName:"p"},"rolebinding-full-access.yaml"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"kind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: st4sd-full-access\n\n  # modify this field if your namespace has a different name\n  namespace: st4sd-full-access-my-namespace\n\nsubjects:\n  - kind: Group\n    apiGroup: rbac.authorization.k8s.io\n\n    # modify this field if your namespace has a different name\n    name: st4sd-full-access-my-namespace\n\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: workflow-user\n")),(0,o.kt)("p",null,"Now, make sure that you:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"have replaced ",(0,o.kt)("inlineCode",{parentName:"li"},"my-namespace")," in the 2 files with the namespace that you deployed ST4SD in."),(0,o.kt)("li",{parentName:"ol"},"have written down the correct account name of your users.",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},"Login to your OpenShift Web Console as an Administrator."),(0,o.kt)("li",{parentName:"ol"},"On the left pane expand the ",(0,o.kt)("inlineCode",{parentName:"li"},"User Management")," menu"),(0,o.kt)("li",{parentName:"ol"},"Click on the ",(0,o.kt)("inlineCode",{parentName:"li"},"Users")," entry"),(0,o.kt)("li",{parentName:"ol"},"Locate the users ",(0,o.kt)("inlineCode",{parentName:"li"},"A")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"B")," in the list and copy the values that you find for them under the ",(0,o.kt)("inlineCode",{parentName:"li"},"Name")," column")))),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"oc create -f group-full-access.yaml && oc create -f rolebinding-full-access.yaml"),". The users ",(0,o.kt)("inlineCode",{parentName:"p"},"A")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"B")," may now access your ST4SD instance."),(0,o.kt)("h2",null,"Give a group of users access to just the ST4SD microservices"),(0,o.kt)("p",null,"You may want to enable two users ",(0,o.kt)("inlineCode",{parentName:"p"},"A")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"B")," to use the ST4SD microservices in the namespace ",(0,o.kt)("inlineCode",{parentName:"p"},"my-namespace")," but be unable to interact with OpenShift in any meaningful way. In this case, put the following in a file called ",(0,o.kt)("inlineCode",{parentName:"p"},"microservices-only.yaml"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"kind: Group\napiVersion: user.openshift.io/v1\nmetadata:\n\n  # modify this field if your namespace has a different name\n  name: st4sd-microservices-only-my-namespace\n\nusers:\n  - Account name of user A\n  - Account name of user B\n")),(0,o.kt)("p",null,"Then create the following file ",(0,o.kt)("inlineCode",{parentName:"p"},"rolebinding-microservices-only.yaml"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"kind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: st4sd-microservices-only\n\n  # modify this field if your namespace has a different name\n  namespace:  my-namespace\n\nsubjects:\n  - kind: Group\n    apiGroup: rbac.authorization.k8s.io\n\n    # modify this field if your namespace has a different name\n    name: st4sd-microservices-only-my-namespace\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: st4sd-authenticate-microservices\n")),(0,o.kt)("p",null,"Now, make sure that you:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"have replaced ",(0,o.kt)("inlineCode",{parentName:"li"},"my-namespace")," in the 2 files with the namespace that you deployed ST4SD in."),(0,o.kt)("li",{parentName:"ol"},"have written down the correct account name of your users.",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},"Login to your OpenShift Web Console as an Administrator."),(0,o.kt)("li",{parentName:"ol"},"On the left pane expand the ",(0,o.kt)("inlineCode",{parentName:"li"},"User Management")," menu"),(0,o.kt)("li",{parentName:"ol"},"Click on the ",(0,o.kt)("inlineCode",{parentName:"li"},"Users")," entry"),(0,o.kt)("li",{parentName:"ol"},"Locate the users ",(0,o.kt)("inlineCode",{parentName:"li"},"A")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"B")," in the list and copy the values that you find for them under the ",(0,o.kt)("inlineCode",{parentName:"li"},"Name")," column")))),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"oc create -f microservices-only.yaml && oc create -f rolebinding-microservices-only.yaml"),". The users ",(0,o.kt)("inlineCode",{parentName:"p"},"A")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"B")," may now access your ST4SD instance."),(0,o.kt)("h2",null,"Role objects that ST4SD creates in its namespace"),(0,o.kt)("p",null,"Deployments of ST4SD on OpenShift contain:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Several ST4SD Microservices (st4sd-runtime-service, st4sd-registry-ui, st4sd-datastore)"),(0,o.kt)("li",{parentName:"ul"},"The ST4SD Workflow Operator (st4sd-runtime-k8s)"),(0,o.kt)("li",{parentName:"ul"},"A Database backend (mongodb)")),(0,o.kt)("p",null,"As a cluster administrator, you can install ST4SD multiple times on your cluster. Each ST4SD deployment is contained to a single namespace. Users of one ST4DS deployment do not necessarily have access to other deployments. The cluster administrator, configures the Role Based Access Control (RBAC) of users to configure which user can access which ST4SD instance."),(0,o.kt)("p",null,"Installing ST4D in a namespace creates the following 2 Role objects in the same namespace:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"st4sd-authenticate-microservices"),": Assigning this role to a user enables them to ",(0,o.kt)("inlineCode",{parentName:"li"},"get")," Service objects in the same namespace as ST4SD. This is the minimum RBAC that a user requires to be able to authenticate to the ST4SD microservices. However, they do not get enough permissions to interact directly with the ST4SD Workflow Operator or other namespaced objects in the same OpenShift project."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"workflow-user"),": Assigning this role to a user enables them to authenticate against the ST4SD microservices. Additionally, it gives them Create Read Update Delete (CRUD) permissions to interact with namespaced objects in the same namespace. This includes the namespaced objects that the ST4SD workflow operator interacts with.")),(0,o.kt)(u,{kind:"info",mdxType:"InlineNotification"},'The 2 roles above do not enable users to modify the "simulationtoolkit" CustomResource objects that st4sd-olm monitors to control the deployment of the ST4SD instance in the namespace.',(0,o.kt)("p",null,"Follow the instructions below to configure the Role Based Access Control for the “simulationtoolkit” objects.")),(0,o.kt)("h2",null,"Enable a namespace administrator to install ST4SD in a namespace"),(0,o.kt)("p",null,"We recommend that you appoint some of the users/administrators of the cluster to be administrator of namespaces that you deploy ST4SD in."),(0,o.kt)("p",null,"You may then assign a Kubernetes Role which enables just the administrators of a namespace to create/modify a ST4SD deployment."),(0,o.kt)("p",null,"For example, if your namespace is called ",(0,o.kt)("inlineCode",{parentName:"p"},"my-namespace")," create the following file: ",(0,o.kt)("inlineCode",{parentName:"p"},"admin-role.yaml")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: authorization.openshift.io/v1\nkind: Role\nmetadata:\n  name: st4sd-olm-permissions\n\n  # modify this field if your namespace has a different name\n  namespace: my-namespace\n\n  labels:\n    deploy.st4sd.ibm.com/component: st4sd-olm-permissions\nrules:\n- apiGroups:\n  - deploy.st4sd.ibm.com\n  resources:\n  - simulationtoolkits\n  verbs:\n  - create\n  - delete\n  - get\n  - list\n  - patch\n  - update\n  - watch\n")),(0,o.kt)("p",null,"Then create the role:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"oc create -f admin-role.yaml\n")),(0,o.kt)("p",null,"Next, create a group for your administrators by placing the following in the file ",(0,o.kt)("inlineCode",{parentName:"p"},"admin-group.yaml"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"kind: Group\napiVersion: user.openshift.io/v1\nmetadata:\n\n  # modify this field if your namespace has a different name\n  name: st4sd-administrators-my-namespace\n\nusers:\n  - Account name of Administrator A\n  - Account name of Administrator B\n")),(0,o.kt)("p",null,"Then create the group:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"oc create -f admin-group.yaml\n")),(0,o.kt)("p",null,"Finally, assign the role to the group by creating the file ",(0,o.kt)("inlineCode",{parentName:"p"},"admin-binding.yaml"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"kind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: st4sd-administrators-my-namespace\n\n  # modify this field if your namespace has a different name\n  namespace:  my-namespace\n\nsubjects:\n  - kind: Group\n    apiGroup: rbac.authorization.k8s.io\n\n    # modify this field if your namespace has a different name\n    name: st4sd-administrators-my-namespace\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: st4sd-olm-permissions\n")),(0,o.kt)("p",null,"Run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"oc create -f admin-binding.yaml\n")),(0,o.kt)("p",null,"You can manage the ST4D administrators for the ",(0,o.kt)("inlineCode",{parentName:"p"},"my-namespace")," namespace by changing the users of the ",(0,o.kt)("inlineCode",{parentName:"p"},"Group")," object ",(0,o.kt)("inlineCode",{parentName:"p"},"st4sd-administrators-my-namespace"),"."))}k.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-cloud-manage-users-mdx-0fced75c5b81451ae135.js.map
"use strict";(self.webpackChunkst4sd_overview=self.webpackChunkst4sd_overview||[]).push([[999],{2032:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return p},default:function(){return h}});var a=t(5987),i=(t(7294),t(3905)),o=t(3461);const r=["components"],p={},s=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",n)},l=s("PageDescription"),m=s("InlineNotification"),d=s("AnchorLinks"),u=s("AnchorLink"),c={_frontmatter:p},k=o.Z;function h(e){let{components:n}=e,t=(0,a.Z)(e,r);return(0,i.kt)(k,Object.assign({},c,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)(l,{mdxType:"PageDescription"},(0,i.kt)("p",null,"A high level overview of how ",(0,i.kt)("inlineCode",{parentName:"p"},"stp")," can help you create and modify packages."),(0,i.kt)(m,{kind:"info",mdxType:"InlineNotification"},(0,i.kt)("p",null,"You can always use the ",(0,i.kt)("inlineCode",{parentName:"p"},"-h")," flag to see additional help for each of the commands\nmentioned here."))),(0,i.kt)(d,{mdxType:"AnchorLinks"},(0,i.kt)(u,{mdxType:"AnchorLink"},"Creating PVEPs"),(0,i.kt)(u,{mdxType:"AnchorLink"},"Updating PVEP definitions"),(0,i.kt)(u,{mdxType:"AnchorLink"},"Checking PVEP syntax")),(0,i.kt)("h2",null,"Prerequisites"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Ensure you have correctly installed the ST4SD Runtime Core module\n(instructions ",(0,i.kt)("a",{parentName:"li",href:"/overview/#try-it-yourself"},"here"),").")),(0,i.kt)("h2",null,"Creating PVEPs"),(0,i.kt)("p",null,"Parameterised Virtual Experiment Packages (PVEPs) are parameterisations of our\nexperiments that need to be created before they can be added the Registry to be\nrun or shared. ",(0,i.kt)("inlineCode",{parentName:"p"},"stp")," can help getting started with this by generating a valid,\nhigh-level PVEP that the user can later add details to."),(0,i.kt)(m,{kind:"info",mdxType:"InlineNotification"},(0,i.kt)("p",null,"This feature requires for the experiment to be in a git repository.")),(0,i.kt)("p",null,"As we need a virtual experiment to test this feature, we will use the\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/st4sd/nanopore-geometry-experiment"},"nanopore-geometry-experiment"),"\nexperiment as our starting point. Let us start by cloning it and ",(0,i.kt)("inlineCode",{parentName:"p"},"cd"),"-ing into\nits directory:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-commandline"},"git clone https://github.com/st4sd/nanopore-geometry-experiment\ncd nanopore-geometry-experiment\n")),(0,i.kt)("p",null,"To create the PVEP we then need to run:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-commandline"},"stp package create --manifest manifest.yaml\n")),(0,i.kt)("p",null,"The resulting PVEP can already be pushed to the Registry using the\n",(0,i.kt)("inlineCode",{parentName:"p"},"stp package push")," command we learned about in the\n",(0,i.kt)("a",{parentName:"p",href:"/overview/getting-and-adding-packages-with-stp#pushing-pveps"},"previous tutorial"),"."),(0,i.kt)("h2",null,"Updating PVEP definitions"),(0,i.kt)("p",null,"During the development phase of our virtual experiments, we will regularly\ncommit changes to the git repository."),(0,i.kt)("p",null,"If we are following the set of\n",(0,i.kt)("a",{parentName:"p",href:"/overview/virtual-experiment-developer-best-practices#strong-versioning"},"best practices"),"\nwe have defined, the commit ID will be included in our PVEP, ensuring ST4SD\nexecutes the ",(0,i.kt)("em",{parentName:"p"},"exact")," version of our experiment, improving results\nreproducibility. Provided is an example of how this might look like in your\nPVEP:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "nanopore-geometry-experiment",\n  "source": {\n    "git": {\n      "location": {\n        "url": "https://github.com/st4sd/nanopore-geometry-experiment",\n        "commit": "85244f5c84d6c0e02aa7a2e1685b004cd0b3cdd2"\n      }\n    }\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"stp")," makes updating the commit ID and metadata tags of our PVEP as painless as\npossible by providing the ",(0,i.kt)("inlineCode",{parentName:"p"},"update-definition")," command. In the\n",(0,i.kt)("inlineCode",{parentName:"p"},"nanopore-geometry-experiment")," folder from the previous example we can run:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-commandline"},"stp package update-definition --path nanopore-geometry-experiment.json \\\n        --use-latest-commit \\\n        --tag latest\n")),(0,i.kt)("p",null,"The PVEP definition may now look similar to the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "base": {\n    "packages": [\n      {\n        "name": "nanopore-geometry-experiment",\n        "source": {\n          "git": {\n            "location": {\n              "url": "https://github.com/st4sd/nanopore-geometry-experiment",\n              "commit": "1682f979531ddef602440f0a3b146edb5916c001"\n            }\n          }\n        },\n      }\n    ]\n  },\n  "metadata": {\n    "package": {\n      ...\n      "tags": [\n        "latest"\n      ],\n    }\n  },\n}\n')),(0,i.kt)("h2",null,"Checking PVEP syntax"),(0,i.kt)("p",null,"When we manually edit our PVEPs, we risk making mistakes. Fortunately, ",(0,i.kt)("inlineCode",{parentName:"p"},"stp"),"\nincludes a syntax checker that can help us identify and fix our errors. Let’s\nintentionally introduce a mistake into our ",(0,i.kt)("inlineCode",{parentName:"p"},"nanopore-geometry-experiment")," PVEP,\nwhich we obtained earlier in this tutorial, by adding a ",(0,i.kt)("inlineCode",{parentName:"p"},"nonexistent")," field to\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"metadata")," section."),(0,i.kt)("p",null,"Here’s how the updated section now looks:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'"metadata": {\n  "package": {\n    "name": "nanopore-geometry-experiment",\n    "tags": [],\n    "license": "",\n    "maintainer": "",\n    "description": "",\n    "nonexistent": true,\n    "keywords": []\n  }\n},\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"stp")," will point us to the error when we run ",(0,i.kt)("inlineCode",{parentName:"p"},"stp package test"),", as such:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-commandline"},"stp package test nanopore-geometry-experiment.json\nValidation error in instance['metadata']['package']:\nAdditional properties are not allowed ('nonexistent' was unexpected)\n")),(0,i.kt)("h2",null,"Next steps"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Learn how to use the ",(0,i.kt)("a",{parentName:"li",href:"/overview/running-workflows-on-openshift"},"ST4SD Python APIs"),"."),(0,i.kt)("li",{parentName:"ul"},"See all the ",(0,i.kt)("a",{parentName:"li",href:"/overview/stp"},"available stp commands"),".")))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-creating-and-modifying-packages-with-stp-mdx-b53677f9df69ef17094d.js.map